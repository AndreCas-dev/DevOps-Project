# Gitleaks Configuration
# https://github.com/gitleaks/gitleaks

title = "DevOps Project Gitleaks Config"

# Use default rules
[extend]
useDefault = true

# Custom rules
[[rules]]
id = "custom-api-key"
description = "Custom API Key Pattern"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*['"]?([a-zA-Z0-9]{32,})['"]?'''
tags = ["key", "api"]

[[rules]]
id = "custom-password"
description = "Hardcoded Password"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['"]([^'"]{8,})['"]'''
tags = ["password"]

# Allowlist - paths/files to ignore
[allowlist]
description = "Allowlisted files and paths"
paths = [
    '''\.env\.example$''',
    '''\.env\.template$''',
    '''secrets/sops/secrets/.*\.enc\.yaml$''',
    '''tests/.*''',
    '''docs/.*''',
    '''node_modules/.*''',
    '''\.git/.*''',
    '''[Mm]onitoring/grafana/grafana\.ini$''',
    '''[Mm]onitoring/alertmanager/alertmanager\.yml$'''
]

# Specific commits to ignore (add as needed)
commits = [
    "e064dd97e16558431adc69884d1c2198425332ba",
    "cdffcd05f580d261e465ee8692cec19c8773e07c"
]

# Regex patterns to ignore
regexes = [
    '''POSTGRES_PASSWORD=postgres''',
    '''GF_ADMIN_PASSWORD=admin''',
    '''EXAMPLE_.*''',
    '''secret_key\s*=\s*SW2YcwTIb9zpOOhoPsMm''',
    '''hooks\.slack\.com/services/.*''',
    '''\{\{\s*item\.password\s*\}\}''',
    '''\{\{\s*[\w\.]+\s*\}\}'''
]
